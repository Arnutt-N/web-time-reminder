<!DOCTYPE html>
<html lang="th">

<head>
    <title>Time Reminder System</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Google Fonts - Noto Sans Thai -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Noto+Sans+Thai:wght@100;200;300;400;500;600;700;800;900&display=swap"
        rel="stylesheet">

    <!-- PWA Manifest -->
    <link rel="manifest"
        href="data:application/json;base64,eyJuYW1lIjoiVGltZSBSZW1pbmRlciBTeXN0ZW0iLCJzaG9ydF9uYW1lIjoiVGltZVJlbWluZGVyIiwiZGlzcGxheSI6InN0YW5kYWxvbmUiLCJiYWNrZ3JvdW5kX2NvbG9yIjoiI2ZmZmZmZiIsInRoZW1lX2NvbG9yIjoiIzY2N2VlYSIsInN0YXJ0X3VybCI6Ii8iLCJpY29ucyI6W3sic3JjIjoiZGF0YTppbWFnZS9zdmcreG1sO2Jhc2U2NCxQSE4yWnlCM2FXUjBhRDBpTWpRaUlHaGxhV2RvZEQwaU1qUWlJR1pwYkd3OUltNXZibVVpSUhacFpYZENiM2c5SWpBZ01DQXlOQ0F5TkNJZ2VHMXNibk05SW1oMGRIQTZMeTkzZDNjdWR6TXViM0puTHpJd01EQXZjM1puSWo0OGNHRjBhQ0JrUFNKTk1USWdObUV5SURJZ01DQXdJREVnTWlBeUlIWTJZVElnTWlBd0lEQXRNaUF0TWlBMklEQXRNaUF5SWpBd2JHSW5JR1pwYkd3OUlpTkdSa0UxTURBaUx6NDhMM04yWno0aUlDQWdJUUVHQUdRaUlHaGxhV2RvZEQwaUlqUTBJaUI5WFN3aWMybDZaU0k2SWpFNU1uZ3hPVElpZlYwOSI%22LCJzaXplcyI6IjE5MngxOTIiLCJ0eXBlIjoiaW1hZ2Uvc3ZnK3htbCJ9XX0%3D">

    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    animation: {
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'bounce-gentle': 'bounce 2s infinite',
                        'fade-in': 'fadeIn 0.5s ease-in-out',
                        'slide-up': 'slideUp 0.3s ease-out',
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0', transform: 'translateY(10px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' }
                        },
                        slideUp: {
                            '0%': { transform: 'translateY(20px)', opacity: '0' },
                            '100%': { transform: 'translateY(0)', opacity: '1' }
                        }
                    },
                    backgroundImage: {
                        'gradient-radial': 'radial-gradient(var(--tw-gradient-stops))',
                        'morning-gradient': 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
                        'evening-gradient': 'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)',
                    }
                }
            }
        }
    </script>
    <style>
        * {
            font-family: 'Noto Sans Thai', 'Inter', system-ui, -apple-system, sans-serif;
        }

        .glass-effect {
            backdrop-filter: blur(16px) saturate(180%);
            -webkit-backdrop-filter: blur(16px) saturate(180%);
            background-color: rgba(255, 255, 255, 0.75);
            border: 1px solid rgba(209, 213, 219, 0.3);
        }

        .dark-glass {
            backdrop-filter: blur(16px) saturate(180%);
            -webkit-backdrop-filter: blur(16px) saturate(180%);
            background-color: rgba(17, 24, 39, 0.8);
            border: 1px solid rgba(75, 85, 99, 0.3);
        }

        .gradient-text {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* Modern Modal Styles */
        .modal-overlay {
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
        }

        .modal-content {
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            background: rgba(255, 255, 255, 0.95);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translate(-50%, -60%) scale(0.8);
            }

            to {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1);
            }
        }

        .modal-animate {
            animation: modalSlideIn 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        /* Mobile and responsive improvements */
        @media (max-width: 768px) {
            .modal-content {
                width: 90vw;
                margin: 0 5vw;
            }

            .time-item {
                padding: 12px 16px;
            }

            .time-item span {
                font-size: 1.125rem;
            }
        }

        @media (max-width: 640px) {
            .glass-effect {
                margin: 0 8px;
            }

            .time-item {
                padding: 10px 12px;
            }
        }
    </style>
</head>

<body class="min-h-screen bg-gradient-to-br from-indigo-100 via-purple-50 to-pink-100">
    <!-- Background Pattern -->
    <div class="fixed inset-0 opacity-30">
        <div class="absolute inset-0 bg-grid-slate-100 [mask-image:linear-gradient(0deg,white,rgba(255,255,255,0.6))]">
        </div>
    </div>

    <!-- Main Container -->
    <div class="relative min-h-screen flex items-center justify-center p-4">
        <div class="w-full max-w-4xl">
            <!-- Header Card -->
            <div class="glass-effect rounded-3xl p-8 mb-6 text-center animate-fade-in">
                <div class="flex items-center justify-center mb-4">
                    <div
                        class="p-4 bg-gradient-to-r from-indigo-500 to-purple-600 rounded-full mr-4 animate-pulse-slow">
                        <svg class="w-8 h-8 text-white" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd"
                                d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z"
                                clip-rule="evenodd"></path>
                        </svg>
                    </div>
                    <h1 class="text-4xl font-bold gradient-text">ระบบแจ้งเตือนลงเวลา</h1>
                </div>

                <!-- Digital Clock -->
                <div class="glass-effect rounded-2xl p-6 mb-6 bg-gradient-to-r from-indigo-500/10 to-purple-500/10">
                    <div id="clock"
                        class="text-5xl md:text-6xl font-mono font-bold text-gray-800 mb-3 tracking-wider text-center">
                    </div>
                    <div class="text-lg text-gray-600 text-center" id="current-date"></div>
                </div>

                <!-- Status Card -->
                <div id="status-card" class="rounded-2xl p-6 mb-8 transition-all duration-500 animate-slide-up">
                    <div id="status" class="text-lg md:text-xl font-semibold text-center"></div>
                </div>

                <!-- Primary Clock In Button - Hero Position -->
                <div class="mb-2">
                    <button onclick="openClockInPage()"
                        class="group relative px-12 py-4 bg-gradient-to-r from-green-500 to-emerald-600 rounded-2xl text-white font-bold text-xl shadow-xl hover:shadow-2xl transition-all duration-300 hover:scale-105 active:scale-95 ring-2 ring-green-300/50 hover:ring-4 hover:ring-green-300/75">
                        <div class="flex items-center justify-center">
                            <svg class="w-7 h-7 mr-3 group-hover:animate-bounce-gentle" fill="currentColor"
                                viewBox="0 0 20 20">
                                <path fill-rule="evenodd"
                                    d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"
                                    clip-rule="evenodd"></path>
                            </svg>
                            ลงเวลา
                        </div>
                        <div
                            class="absolute inset-0 bg-gradient-to-r from-green-400 to-emerald-500 rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity duration-300 -z-10">
                        </div>
                    </button>
                </div>
            </div>

            <!-- Time Schedule Grid -->
            <div class="grid md:grid-cols-2 gap-4 md:gap-6 mb-6">
                <!-- Morning Schedule -->
                <div class="glass-effect rounded-3xl p-4 md:p-6 animate-fade-in relative" style="animation-delay: 0.1s">
                    <div class="flex items-center justify-between mb-6">
                        <div class="flex items-center">
                            <div class="p-3 bg-gradient-to-r from-yellow-400 to-orange-500 rounded-full mr-4">
                                <svg class="w-6 h-6 text-white" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd"
                                        d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l-.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z"
                                        clip-rule="evenodd"></path>
                                </svg>
                            </div>
                            <h3 class="text-2xl font-bold text-gray-800">ตอนเช้า</h3>
                        </div>

                        <!-- Test Button - Aligned with Header -->
                        <button onclick="testMorning()"
                            class="px-3 py-1.5 bg-gradient-to-r from-yellow-400 to-orange-500 rounded-lg text-white font-medium text-sm shadow-sm hover:shadow-md transition-all duration-300 hover:scale-105 active:scale-95">
                            ทดสอบ
                        </button>
                    </div>
                    <div class="space-y-3">
                        <div class="time-item flex items-center justify-between p-4 rounded-xl transition-all duration-300 hover:scale-105"
                            id="time-0725">
                            <span class="text-xl font-semibold text-gray-700">07:25</span>
                            <div class="w-3 h-3 rounded-full bg-gray-300 time-indicator"></div>
                        </div>
                        <div class="time-item flex items-center justify-between p-4 rounded-xl transition-all duration-300 hover:scale-105"
                            id="time-0825">
                            <span class="text-xl font-semibold text-gray-700">08:25</span>
                            <div class="w-3 h-3 rounded-full bg-gray-300 time-indicator"></div>
                        </div>
                        <div class="time-item flex items-center justify-between p-4 rounded-xl transition-all duration-300 hover:scale-105"
                            id="time-0925">
                            <span class="text-xl font-semibold text-gray-700">09:25</span>
                            <div class="w-3 h-3 rounded-full bg-gray-300 time-indicator"></div>
                        </div>
                    </div>
                </div>

                <!-- Evening Schedule -->
                <div class="glass-effect rounded-3xl p-4 md:p-6 animate-fade-in relative" style="animation-delay: 0.2s">
                    <div class="flex items-center justify-between mb-6">
                        <div class="flex items-center">
                            <div class="p-3 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full mr-4">
                                <svg class="w-6 h-6 text-white" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path>
                                </svg>
                            </div>
                            <h3 class="text-2xl font-bold text-gray-800">ตอนบ่าย</h3>
                        </div>

                        <!-- Test Button - Aligned with Header -->
                        <button onclick="testEvening()"
                            class="px-3 py-1.5 bg-gradient-to-r from-purple-500 to-pink-500 rounded-lg text-white font-medium text-sm shadow-sm hover:shadow-md transition-all duration-300 hover:scale-105 active:scale-95">
                            ทดสอบ
                        </button>
                    </div>
                    <div class="space-y-3">
                        <div class="time-item flex items-center justify-between p-4 rounded-xl transition-all duration-300 hover:scale-105"
                            id="time-1530">
                            <span class="text-xl font-semibold text-gray-700">15:30</span>
                            <div class="w-3 h-3 rounded-full bg-gray-300 time-indicator"></div>
                        </div>
                        <div class="time-item flex items-center justify-between p-4 rounded-xl transition-all duration-300 hover:scale-105"
                            id="time-1630">
                            <span class="text-xl font-semibold text-gray-700">16:30</span>
                            <div class="w-3 h-3 rounded-full bg-gray-300 time-indicator"></div>
                        </div>
                        <div class="time-item flex items-center justify-between p-4 rounded-xl transition-all duration-300 hover:scale-105"
                            id="time-1730">
                            <span class="text-xl font-semibold text-gray-700">17:30</span>
                            <div class="w-3 h-3 rounded-full bg-gray-300 time-indicator"></div>
                        </div>
                    </div>
                </div>
            </div>


            <!-- Activity Log -->
            <div class="glass-effect rounded-3xl p-4 md:p-6 animate-fade-in relative" style="animation-delay: 0.4s">
                <div class="flex items-center justify-between mb-4">
                    <div class="flex items-center">
                        <div class="p-2 bg-gradient-to-r from-blue-500 to-indigo-600 rounded-full mr-3">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd"
                                    d="M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z"
                                    clip-rule="evenodd"></path>
                            </svg>
                        </div>
                        <h3 class="text-lg md:text-xl font-bold text-gray-800">บันทึกการทำงาน</h3>
                    </div>

                    <!-- Settings Button - Aligned with Header -->
                    <button onclick="showSettings()"
                        class="group px-3 py-2 bg-gradient-to-r from-gray-400 to-gray-500 rounded-xl shadow-md hover:shadow-lg transition-all duration-300 hover:scale-105 active:scale-95 hover:from-gray-500 hover:to-gray-600">
                        <div class="flex items-center">
                            <svg class="w-4 h-4 text-white mr-1.5 group-hover:animate-spin" fill="currentColor"
                                viewBox="0 0 20 20">
                                <path fill-rule="evenodd"
                                    d="M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z"
                                    clip-rule="evenodd"></path>
                            </svg>
                            <span class="text-white font-medium text-sm">ตั้งค่า</span>
                        </div>
                    </button>
                </div>

                <!-- Activity Log Display -->
                <div class="dark-glass rounded-2xl p-3 md:p-4 max-h-36 md:max-h-48 overflow-y-auto" id="log">
                    <div class="text-green-400 font-mono text-xs md:text-sm">🚀 ระบบเริ่มต้นทำงาน...</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modern Modal Alert -->
    <div id="modern-modal" class="fixed inset-0 z-50 hidden modal-overlay" style="background: rgba(0, 0, 0, 0.5);">
        <div
            class="modal-content fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 rounded-3xl p-8 max-w-md w-full mx-4 modal-animate">
            <div class="text-center">
                <div class="mb-6">
                    <div id="modal-icon" class="mx-auto w-20 h-20 rounded-full flex items-center justify-center mb-4">
                        <!-- Dynamic icon will be inserted here -->
                    </div>
                    <h3 id="modal-title" class="text-2xl font-bold text-gray-800 mb-2"></h3>
                    <p id="modal-message" class="text-gray-600 text-lg leading-relaxed"></p>
                </div>

                <div class="flex flex-col sm:flex-row gap-3 justify-center">
                    <button id="modal-clock-btn" onclick="handleModalClockIn()"
                        class="px-8 py-4 bg-gradient-to-r from-green-500 to-emerald-600 text-white font-bold rounded-2xl shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105 active:scale-95 flex items-center justify-center">
                        <svg class="w-6 h-6 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd"
                                d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"
                                clip-rule="evenodd"></path>
                        </svg>
                        ลงเวลา
                    </button>
                    <button onclick="closeModernModal()"
                        class="px-8 py-4 bg-gradient-to-r from-gray-400 to-gray-500 text-white font-semibold rounded-2xl shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105 active:scale-95">
                        ปิด
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settings-modal" class="fixed inset-0 z-50 hidden modal-overlay" style="background: rgba(0, 0, 0, 0.5);">
        <div
            class="modal-content fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 rounded-3xl p-8 max-w-lg w-full mx-4 modal-animate">
            <div class="text-center mb-6">
                <h3 class="text-2xl font-bold text-gray-800 mb-2">ตั้งค่าการแจ้งเตือน</h3>
                <p class="text-gray-600">ปรับแต่งเสียงและการสั่น</p>
            </div>

            <div class="space-y-6">
                <!-- Sound Settings -->
                <div class="flex items-center justify-between">
                    <div>
                        <h4 class="font-semibold text-gray-800">เสียงแจ้งเตือน</h4>
                        <p class="text-sm text-gray-600">เปิด/ปิดเสียงแจ้งเตือน</p>
                    </div>
                    <label class="relative inline-flex items-center cursor-pointer">
                        <input type="checkbox" id="sound-toggle" class="sr-only peer" checked>
                        <div
                            class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600">
                        </div>
                    </label>
                </div>

                <!-- Vibration Settings -->
                <div class="flex items-center justify-between">
                    <div>
                        <h4 class="font-semibold text-gray-800">การสั่น (มือถือ)</h4>
                        <p class="text-sm text-gray-600">เปิด/ปิดการสั่นในอุปกรณ์มือถือ</p>
                    </div>
                    <label class="relative inline-flex items-center cursor-pointer">
                        <input type="checkbox" id="vibration-toggle" class="sr-only peer" checked>
                        <div
                            class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600">
                        </div>
                    </label>
                </div>

                <!-- Weekend/Holiday Settings -->
                <div class="flex items-center justify-between">
                    <div>
                        <h4 class="font-semibold text-gray-800">หยุดสุดสัปดาห์</h4>
                        <p class="text-sm text-gray-600">ปิดการแจ้งเตือนวันเสาร์-อาทิตย์</p>
                    </div>
                    <label class="relative inline-flex items-center cursor-pointer">
                        <input type="checkbox" id="weekend-toggle" class="sr-only peer" checked>
                        <div
                            class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600">
                        </div>
                    </label>
                </div>
            </div>

            <div class="flex gap-3 justify-center mt-8">
                <button onclick="saveSettings()"
                    class="px-8 py-4 bg-gradient-to-r from-blue-500 to-indigo-600 text-white font-bold rounded-2xl shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105">
                    บันทึก
                </button>
                <button onclick="closeSettings()"
                    class="px-8 py-4 bg-gradient-to-r from-gray-400 to-gray-500 text-white font-semibold rounded-2xl shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105">
                    ปิด
                </button>
            </div>
        </div>
    </div>

    <!-- Notification Toast (Hidden by default) -->
    <div id="toast" class="fixed top-4 right-4 transform translate-x-full transition-transform duration-300 z-50">
        <div class="glass-effect rounded-2xl p-4 shadow-2xl max-w-md">
            <div class="flex items-center">
                <div class="p-2 bg-gradient-to-r from-green-400 to-blue-500 rounded-full mr-3">
                    <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd"
                            d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"
                            clip-rule="evenodd"></path>
                    </svg>
                </div>
                <div>
                    <div class="font-semibold text-gray-800" id="toast-title">แจ้งเตือน</div>
                    <div class="text-gray-600 text-sm" id="toast-message">ข้อความแจ้งเตือน</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // เวลาที่ต้องการแจ้งเตือน
        const reminderTimes = [
            { time: "07:25", type: "morning", id: "time-0725" },
            { time: "08:25", type: "morning", id: "time-0825" },
            { time: "09:25", type: "morning", id: "time-0925" },
            { time: "15:30", type: "evening", id: "time-1530" },
            { time: "16:30", type: "evening", id: "time-1630" },
            { time: "17:30", type: "evening", id: "time-1730" }
        ];

        // Settings
        let settings = {
            sound: true,
            vibration: true,
            weekend: true
        };

        // Clock-in URL (Ministry of Justice intranet)
        let clockInUrl = "https://intranet.moj.go.th/";

        // Audio for notifications
        let notificationSound = null;

        // Service Worker for background notifications
        let swRegistration = null;

        // เก็บเวลาที่แจ้งเตือนไปแล้วในวันนี้
        let alertedToday = new Set();
        let currentDate = new Date().toDateString();

        function getCurrentTime() {
            const now = new Date();
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            const seconds = String(now.getSeconds()).padStart(2, '0');
            return { time: `${hours}:${minutes}`, display: `${hours}:${minutes}:${seconds}` };
        }

        function getCurrentDate() {
            return new Date().toLocaleDateString('th-TH', {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
        }

        function showToast(title, message, duration = 3000) {
            const toast = document.getElementById('toast');
            const toastTitle = document.getElementById('toast-title');
            const toastMessage = document.getElementById('toast-message');

            toastTitle.textContent = title;
            toastMessage.textContent = message;

            // Show toast
            toast.classList.remove('translate-x-full');
            toast.classList.add('translate-x-0');

            // Hide after duration
            setTimeout(() => {
                toast.classList.remove('translate-x-0');
                toast.classList.add('translate-x-full');
            }, duration);
        }

        function showAlertOverlay(title, message) {
            const overlay = document.getElementById('alert-overlay');
            const titleElement = document.getElementById('alert-title');
            const messageElement = document.getElementById('alert-message');

            titleElement.textContent = title;
            messageElement.textContent = message;

            overlay.classList.remove('hidden');

            // Auto close after 15 seconds
            setTimeout(() => {
                closeAlertOverlay();
            }, 15000);
        }

        function closeAlertOverlay() {
            const overlay = document.getElementById('alert-overlay');
            overlay.classList.add('hidden');
        }

        function addLog(message, type = 'info') {
            const log = document.getElementById('log');
            const timestamp = new Date().toLocaleTimeString('th-TH');
            const colors = {
                info: 'text-blue-400',
                success: 'text-green-400',
                warning: 'text-yellow-400',
                error: 'text-red-400'
            };

            const logEntry = document.createElement('div');
            logEntry.className = `${colors[type]} font-mono text-sm mb-1 animate-fade-in`;
            logEntry.innerHTML = `[${timestamp}] ${message}`;

            log.appendChild(logEntry);
            log.scrollTop = log.scrollHeight;
        }

        // Modern Modal Functions
        function showModernModal(title, message, type) {
            const modal = document.getElementById('modern-modal');
            const titleElement = document.getElementById('modal-title');
            const messageElement = document.getElementById('modal-message');
            const iconElement = document.getElementById('modal-icon');

            titleElement.textContent = title;
            messageElement.textContent = message;

            // Set icon based on type
            if (type === 'morning') {
                iconElement.className = 'mx-auto w-20 h-20 bg-gradient-to-r from-yellow-400 to-orange-500 rounded-full flex items-center justify-center mb-4';
                iconElement.innerHTML = `<svg class="w-12 h-12 text-white" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" clip-rule="evenodd"></path>
                </svg>`;
            } else {
                iconElement.className = 'mx-auto w-20 h-20 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full flex items-center justify-center mb-4';
                iconElement.innerHTML = `<svg class="w-12 h-12 text-white" fill="currentColor" viewBox="0 0 20 20">
                    <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path>
                </svg>`;
            }

            modal.classList.remove('hidden');

            // Play sound if enabled
            if (settings.sound) {
                playNotificationSound();
            }

            // Vibrate if enabled and supported
            if (settings.vibration && 'vibrate' in navigator) {
                navigator.vibrate([200, 100, 200, 100, 200]);
            }

            // Auto close after 15 seconds if no interaction
            setTimeout(() => {
                if (!modal.classList.contains('hidden')) {
                    closeModernModal();
                }
            }, 15000);
        }

        function closeModernModal() {
            const modal = document.getElementById('modern-modal');
            modal.classList.add('hidden');
        }

        function handleModalClockIn() {
            if (clockInUrl && clockInUrl !== '#') {
                window.open(clockInUrl, '_blank');
            }
            closeModernModal();
            addLog("✅ เปิดหน้าลงเวลาเรียบร้อย", "success");
            showToast("สำเร็จ", "เปิดหน้าลงเวลาในแท็บใหม่");
        }

        function showMorningMessage() {
            const message = `🌅 สวัสดีตอนเช้า! วันที่ ${getCurrentDate()} ขอให้มีวันที่ดีนะครับ/คะ 😊 อย่าลืมลงเวลาเข้างาน!`;

            // Show modern modal instead of confirm
            showModernModal("🌅 แจ้งเตือนตอนเช้า", message, "morning");

            addLog("🌅 แจ้งเตือนตอนเช้าเรียบร้อย", "success");

            // Browser notification for background
            if ("Notification" in window && Notification.permission === "granted") {
                new Notification("🌅 แจ้งเตือนลงเวลาเข้างาน", {
                    body: "อย่าลืมลงเวลาเข้างานนะครับ/คะ",
                    icon: "/favicon.ico",
                    requireInteraction: true,
                    tag: 'time-reminder'
                });
            }
        }

        function showEveningMessage() {
            const message = `🌆 สวัสดีตอนบ่าย! วันที่ ${getCurrentDate()} ขอบคุณสำหรับความทุ่มเทในวันนี้นะครับ/คะ 💪 อย่าลืมลงเวลาออกจากงาน!`;

            // Show modern modal instead of confirm
            showModernModal("🌆 แจ้งเตือนตอนบ่าย", message, "evening");

            addLog("🌆 แจ้งเตือนตอนบ่ายเรียบร้อย", "success");

            // Browser notification for background
            if ("Notification" in window && Notification.permission === "granted") {
                new Notification("🌆 แจ้งเตือนลงเวลาออกงาน", {
                    body: "อย่าลืมลงเวลาออกงานนะครับ/คะ",
                    icon: "/favicon.ico",
                    requireInteraction: true,
                    tag: 'time-reminder'
                });
            }
        }

        // Settings Functions
        function showSettings() {
            const modal = document.getElementById('settings-modal');

            // Load current settings into toggles
            document.getElementById('sound-toggle').checked = settings.sound;
            document.getElementById('vibration-toggle').checked = settings.vibration;
            document.getElementById('weekend-toggle').checked = settings.weekend;

            modal.classList.remove('hidden');
        }

        function closeSettings() {
            const modal = document.getElementById('settings-modal');
            modal.classList.add('hidden');
        }

        function saveSettings() {
            settings.sound = document.getElementById('sound-toggle').checked;
            settings.vibration = document.getElementById('vibration-toggle').checked;
            settings.weekend = document.getElementById('weekend-toggle').checked;

            // Save to localStorage
            localStorage.setItem('timeReminderSettings', JSON.stringify(settings));

            closeSettings();
            showToast("บันทึกสำเร็จ", "ตั้งค่าได้ถูกบันทึกแล้ว");
            addLog("⚙️ บันทึกการตั้งค่าเรียบร้อย", "success");
        }

        function loadSettings() {
            const saved = localStorage.getItem('timeReminderSettings');
            if (saved) {
                settings = { ...settings, ...JSON.parse(saved) };
            }
        }

        // Main Clock In Button Function
        function openClockInPage() {
            if (clockInUrl && clockInUrl !== '#') {
                window.open(clockInUrl, '_blank');
                addLog("🎯 เปิดหน้าลงเวลาหลัก", "success");
                showToast("เปิดแล้ว", "เปิดหน้าลงเวลาในแท็บใหม่");
            } else {
                showToast("ยังไม่ได้ตั้งค่า", "กรุณาตั้งค่า URL สำหรับลงเวลา");
            }
        }

        // Sound Functions
        function initializeSound() {
            // Create notification sound using Web Audio API
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();

                notificationSound = {
                    play: function () {
                        const oscillator = audioContext.createOscillator();
                        const gainNode = audioContext.createGain();

                        oscillator.connect(gainNode);
                        gainNode.connect(audioContext.destination);

                        oscillator.frequency.setValueAtTime(800, audioContext.currentTime);
                        oscillator.frequency.setValueAtTime(600, audioContext.currentTime + 0.1);
                        oscillator.frequency.setValueAtTime(800, audioContext.currentTime + 0.2);

                        gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);

                        oscillator.start(audioContext.currentTime);
                        oscillator.stop(audioContext.currentTime + 0.3);
                    }
                };
            } catch (e) {
                console.warn("Could not initialize sound:", e);
            }
        }

        function playNotificationSound() {
            if (notificationSound) {
                try {
                    notificationSound.play();
                } catch (e) {
                    console.warn("Could not play sound:", e);
                }
            }
        }

        // Weekend/Holiday Check
        function isWeekendOrHoliday() {
            if (!settings.weekend) return false;

            const today = new Date();
            const dayOfWeek = today.getDay(); // 0 = Sunday, 6 = Saturday

            return dayOfWeek === 0 || dayOfWeek === 6;
        }

        function updateTimeDisplay() {
            const { time: currentTime, display: displayTime } = getCurrentTime();

            // Update clock display
            document.getElementById('clock').textContent = displayTime;
            document.getElementById('current-date').textContent = getCurrentDate();

            // Check if it's a new day
            const today = new Date().toDateString();
            if (today !== currentDate) {
                currentDate = today;
                alertedToday.clear();
                addLog("🗓️ เริ่มวันใหม่ - รีเซ็ตการแจ้งเตือน", "info");
            }

            // Reset all time indicators
            reminderTimes.forEach(reminder => {
                const element = document.getElementById(reminder.id);
                const indicator = element.querySelector('.time-indicator');
                element.classList.remove('bg-gradient-to-r', 'from-green-400', 'to-blue-500', 'shadow-lg', 'scale-105');
                element.classList.add('bg-gray-100');
                indicator.classList.remove('bg-green-500', 'animate-pulse');
                indicator.classList.add('bg-gray-300');
            });

            // Check for reminder times
            let nextReminder = null;
            let isReminderTime = false;

            reminderTimes.forEach(reminder => {
                if (currentTime === reminder.time) {
                    // Highlight current reminder time
                    const element = document.getElementById(reminder.id);
                    const indicator = element.querySelector('.time-indicator');
                    element.classList.remove('bg-gray-100');
                    element.classList.add('bg-gradient-to-r', 'from-green-400', 'to-blue-500', 'shadow-lg', 'scale-105');
                    indicator.classList.remove('bg-gray-300');
                    indicator.classList.add('bg-green-500', 'animate-pulse');

                    isReminderTime = true;

                    // Show reminder if not already shown today and not weekend (if enabled)
                    if (!alertedToday.has(reminder.time) && !isWeekendOrHoliday()) {
                        alertedToday.add(reminder.time);

                        if (reminder.type === "morning") {
                            showMorningMessage();
                        } else {
                            showEveningMessage();
                        }
                    }
                }

                // Find next reminder
                const [reminderHour, reminderMinute] = reminder.time.split(':').map(Number);
                const [currentHour, currentMinute] = currentTime.split(':').map(Number);

                const reminderMinutes = reminderHour * 60 + reminderMinute;
                const currentMinutes = currentHour * 60 + currentMinute;

                if (reminderMinutes > currentMinutes) {
                    if (!nextReminder || reminderMinutes < nextReminder.totalMinutes) {
                        nextReminder = {
                            time: reminder.time,
                            type: reminder.type,
                            totalMinutes: reminderMinutes
                        };
                    }
                }
            });

            // Update status
            const statusCard = document.getElementById('status-card');
            const statusElement = document.getElementById('status');

            if (isReminderTime) {
                statusElement.innerHTML = "🔔 <strong>เวลาแจ้งเตือน!</strong>";
                statusCard.className = "rounded-2xl p-6 mb-8 transition-all duration-500 animate-slide-up bg-gradient-to-r from-red-100 to-pink-100 border-2 border-red-300";
            } else if (nextReminder) {
                const timeUntil = nextReminder.totalMinutes - (new Date().getHours() * 60 + new Date().getMinutes());
                const hoursUntil = Math.floor(timeUntil / 60);
                const minutesUntil = timeUntil % 60;

                let timeString = "";
                if (hoursUntil > 0) {
                    timeString = `${hoursUntil} ชม. ${minutesUntil} นาที`;
                } else {
                    timeString = `${minutesUntil} นาที`;
                }

                statusElement.innerHTML = `⏳ การแจ้งเตือนถัดไป: <strong>${nextReminder.time}</strong> (อีก ${timeString})`;
                statusCard.className = "rounded-2xl p-6 mb-8 transition-all duration-500 animate-slide-up bg-gradient-to-r from-blue-50 to-indigo-50 border-2 border-blue-200";
            } else {
                // Check if it's weekend/holiday
                if (isWeekendOrHoliday()) {
                    statusElement.innerHTML = "📴 วันหยุด - ปิดการแจ้งเตือนชั่วคราว";
                    statusCard.className = "rounded-2xl p-6 mb-8 transition-all duration-500 animate-slide-up bg-gradient-to-r from-orange-50 to-yellow-50 border-2 border-orange-200";
                } else {
                    statusElement.innerHTML = "✅ เสร็จสิ้นการแจ้งเตือนสำหรับวันนี้";
                    statusCard.className = "rounded-2xl p-6 mb-8 transition-all duration-500 animate-slide-up bg-gradient-to-r from-green-50 to-emerald-50 border-2 border-green-200";
                }
            }
        }

        function testMorning() {
            showMorningMessage();
        }

        function testEvening() {
            showEveningMessage();
        }

        // Initialize system
        async function initializeSystem() {
            addLog("🚀 เริ่มต้นระบบแจ้งเตือนลงเวลา", "success");

            // Load saved settings
            loadSettings();

            // Initialize sound system
            initializeSound();

            // Request notification permission
            if ("Notification" in window && Notification.permission === "default") {
                Notification.requestPermission().then(permission => {
                    if (permission === "granted") {
                        addLog("✅ ได้รับอนุญาต Browser Notification", "success");
                        showToast("สำเร็จ!", "ได้รับอนุญาต Browser Notification");
                    } else {
                        addLog("⚠️ ไม่ได้รับอนุญาต Browser Notification", "warning");
                    }
                });
            }

            // Register service worker for background notifications
            if ('serviceWorker' in navigator && 'PushManager' in window) {
                try {
                    const registration = await navigator.serviceWorker.register('data:application/javascript;base64,c2VsZi5hZGRFdmVudExpc3RlbmVyKCdub3RpZmljYXRpb25jbGljaycsIGV2ZW50ID0+IHsKICBldmVudC5ub3RpZmljYXRpb24uY2xvc2UoKTsKICBldmVudC53YWl0VW50aWwoY2xpZW50cy5vcGVuV2luZG93KCcvJykpOwp9KTs=');
                    swRegistration = registration;
                    addLog("✅ ลงทะเบียน Service Worker สำเร็จ", "success");
                } catch (error) {
                    console.warn("Service Worker registration failed:", error);
                }
            }

            // Start time checking every second
            setInterval(updateTimeDisplay, 1000);
            updateTimeDisplay(); // Run immediately

            addLog(`📅 เริ่มการแจ้งเตือนสำหรับวันที่ ${getCurrentDate()}`, "info");
            showToast("ระบบพร้อม!", "ระบบแจ้งเตือนเริ่มทำงานแล้ว");

            // Check if weekend mode is enabled
            if (settings.weekend && isWeekendOrHoliday()) {
                addLog("📴 วันหยุด - ปิดการแจ้งเตือนชั่วคราว", "warning");
                showToast("วันหยุด", "ปิดการแจ้งเตือนวันเสาร์-อาทิตย์");
            }
        }

        // Start system when page loads
        window.onload = initializeSystem;

        // Warn before closing tab
        window.addEventListener('beforeunload', function (e) {
            e.preventDefault();
            e.returnValue = 'คุณต้องการปิดระบบแจ้งเตือนหรือไม่?';
        });

        // Add some interactive effects
        document.addEventListener('DOMContentLoaded', function () {
            // Add hover effects to time items
            const timeItems = document.querySelectorAll('.time-item');
            timeItems.forEach(item => {
                item.addEventListener('mouseenter', function () {
                    if (!this.classList.contains('scale-105')) {
                        this.style.transform = 'translateY(-2px)';
                        this.style.boxShadow = '0 4px 12px rgba(0,0,0,0.15)';
                    }
                });

                item.addEventListener('mouseleave', function () {
                    if (!this.classList.contains('scale-105')) {
                        this.style.transform = 'translateY(0)';
                        this.style.boxShadow = 'none';
                    }
                });
            });
        });
    </script>
</body>

</html>
